(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();class u{constructor(e="content",t="changelog-content",n="command-input",i="run-command"){this.typingTimeout=null,this.animationSettings={typingSpeed:10,lineDelay:100,wipeSpeed:10,wipeChars:5},this.contentElement=document.getElementById(e),this.changelogContentElement=document.getElementById(t),this.commandInputElement=document.getElementById(n),this.runCommandButton=document.getElementById(i),(!this.contentElement||!this.changelogContentElement||!this.commandInputElement||!this.runCommandButton)&&console.error("UIController: Required DOM elements not found!")}updateAnimationSettings(e){this.animationSettings={...this.animationSettings,...e}}ensureSectionWrapper(e,t){const n=`section-wrapper-${e}`;let i=document.getElementById(n);return i||(i=document.createElement("div"),i.id=n,i.className="content-section",t&&i.classList.add(t),this.contentElement.appendChild(i)),i}renderInitialPageContent(e){this.contentElement.innerHTML="",e.forEach(t=>{const n=this.ensureSectionWrapper(t.id,t.className);t.elements.forEach(i=>{if(i.versions&&i.versions.length>0){const o=i.versions[0],s=document.createElement(i.tag);s.id=i.id,i.className&&s.classList.add(i.className),s.textContent=o.text,n.appendChild(s)}})})}renderAnimatedElement(e,t,n){return new Promise(i=>{const o=this.ensureSectionWrapper(t.className?`${e}-${t.className}`:e,t.className),s=document.createElement(t.tag);s.id=t.id,t.className&&s.classList.add(t.className),o.appendChild(s),this.typeText(s,n,0,i)})}renderElementDirectly(e,t,n){const i=this.ensureSectionWrapper(e,t.className),o=document.createElement(t.tag);o.id=t.id,t.className&&o.classList.add(t.className),o.textContent=n,i.appendChild(o)}updateAnimatedElement(e,t){return new Promise((n,i)=>{const o=document.getElementById(e);if(!o){console.error(`Element with ID ${e} not found for update.`),i(new Error(`Element ${e} not found`));return}o.textContent="",this.typeText(o,t,0,n)})}removeElementById(e){const t=document.getElementById(e);t&&t.parentNode?t.parentNode.removeChild(t):console.warn(`Element with ID ${e} not found for removal.`)}removeSectionWrapper(e){const t=`section-wrapper-${e}`,n=document.getElementById(t);n&&n.parentNode&&n.parentNode.removeChild(n)}wipeAndClearContent(){return new Promise(e=>{const t=this.contentElement.innerHTML;let n=t.length;const i=()=>{if(n<=0){this.contentElement.innerHTML="",e();return}this.contentElement.innerHTML=t.substring(0,n),n-=this.animationSettings.wipeChars,setTimeout(i,this.animationSettings.wipeSpeed)};i()})}clearContentImmediate(){this.contentElement.innerHTML=""}setSectionVisualState(e,t){const n=`section-wrapper-${e}`,i=document.getElementById(n);i&&(i.classList.remove("state-default","state-inProgress","state-error"),t!=="default"&&i.classList.add(`state-${t}`),i.classList.contains("content-section")||i.classList.add("content-section"))}addLogEntry(e,t=""){const n=document.createElement("div");n.className=t?`changelog-entry ${t}`:"changelog-entry",n.textContent=e,this.changelogContentElement.appendChild(n),this.scrollToBottom()}clearLog(){this.changelogContentElement.innerHTML=""}scrollToBottom(){setTimeout(()=>{this.changelogContentElement.scrollTop=this.changelogContentElement.scrollHeight},10)}setupCommandInput(e){!this.commandInputElement||!this.runCommandButton||(this.runCommandButton.addEventListener("click",()=>{const t=this.commandInputElement.value.trim();t&&(e(t),this.commandInputElement.value="")}),this.commandInputElement.addEventListener("keypress",t=>{if(t.key==="Enter"){const n=this.commandInputElement.value.trim();n&&(e(n),this.commandInputElement.value="")}}))}typeText(e,t,n=0,i){n<t.length?(e.textContent=t.substring(0,n+1),this.typingTimeout=setTimeout(()=>{this.typeText(e,t,n+1,i)},this.animationSettings.typingSpeed)):i&&setTimeout(i,this.animationSettings.lineDelay)}clearAllTimeouts(){this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null)}}const p=7,m=67,h=533,I=7,f=8,g="Make awesome profile page with lots of skills",y={meta:{siteTitle:"Leo Vainio - Developer & Designer",initialUserPrompt:"[USER] build awesome profile page with lots of cool skills",animationSettings:{typingSpeed:p,lineDelay:m,commandDelay:h,wipeSpeed:I,wipeChars:f}},sections:[{id:"initialExample",type:"block",displayInitially:!0,elements:[{id:"init-hello",tag:"h1",versions:[{versionId:"v1",text:"HELLO WORLD"}]},{id:"init-example-site",tag:"p",versions:[{versionId:"v1",text:"This is example site"}]}]},{id:"header",type:"block",elements:[{id:"header-h1-name",tag:"h1",versions:[{versionId:"v1",text:"Leo Vainio",isFinal:!0}]},{id:"header-h2-title",tag:"h2",versions:[{versionId:"v1",text:"Developer & Designer"},{versionId:"v2",text:"Full-Stack Developer & UX Designer",isFinal:!0}]}]},{id:"sep1",type:"separator",separatorText:"----------------------------"},{id:"about",type:"block",elements:[{id:"about-h2",tag:"h2",versions:[{versionId:"v1",text:"About Me",isFinal:!0}]},{id:"about-p1",tag:"p",versions:[{versionId:"v1",text:"I am a passionate developer with interests in web development and design."},{versionId:"v2",text:"I am a passionate software engineer with expertise in modern web development and user experience design.",isFinal:!0,critiqueOfPrevious:"Refined for a more professional tone."}]},{id:"about-p2",tag:"p",versions:[{versionId:"v1",text:"This website is a demonstration of text generation line by line, similar to code generation in editors."},{versionId:"v2",text:"With a strong foundation in both frontend and backend technologies, I create elegant solutions to complex problems.",isFinal:!0,critiqueOfPrevious:"Expanded on capabilities."}]}]},{id:"sep2",type:"separator",separatorText:"----------------------------"},{id:"skills",type:"block",elements:[{id:"skills-h2",tag:"h2",versions:[{versionId:"v1",text:"Skills"},{versionId:"v2",text:"Core Skills",isFinal:!0}]},{id:"skills-js",tag:"p",versions:[{versionId:"v1",text:"• JavaScript/TypeScript"},{versionId:"v2",text:"• JavaScript/TypeScript (React, Next.js, Vue.js)",isFinal:!0}]},{id:"skills-html",tag:"p",versions:[{versionId:"v1",text:"• HTML & CSS",isFinal:!0}]},{id:"skills-react",tag:"p",versions:[{versionId:"v1",text:"• React"}]},{id:"skills-node",tag:"p",versions:[{versionId:"v1",text:"• Node.js"},{versionId:"v2",text:"• Node.js (Express, NestJS)",isFinal:!0}]},{id:"skills-python",tag:"p",versions:[{versionId:"v2",text:"• Python (Django, Flask, FastAPI)",isFinal:!0}]},{id:"skills-graphql",tag:"p",versions:[{versionId:"v2",text:"• GraphQL & RESTful API Design",isFinal:!0}]},{id:"skills-cloud",tag:"p",versions:[{versionId:"v2",text:"• Cloud Architecture (AWS, Azure)",isFinal:!0}]},{id:"skills-devops",tag:"p",versions:[{versionId:"v2",text:"• DevOps (Docker, Kubernetes, CI/CD)",isFinal:!0}]},{id:"skills-uiux",tag:"p",versions:[{versionId:"v1",text:"• UI/UX Design"},{versionId:"v2",text:"• UI/UX Design (Figma, Adobe Suite)",isFinal:!0}]}]},{id:"sep3",type:"separator",separatorText:"----------------------------"},{id:"contact",type:"block",elements:[{id:"contact-h2",tag:"h2",versions:[{versionId:"v1",text:"Contact",isFinal:!0}]},{id:"contact-email",tag:"p",versions:[{versionId:"v1",text:"Email: example@example.com",isFinal:!0}]},{id:"contact-github",tag:"p",versions:[{versionId:"v1",text:"GitHub: github.com/username",isFinal:!0}]},{id:"contact-linkedin",tag:"p",versions:[{versionId:"v1",text:"LinkedIn: linkedin.com/in/username",isFinal:!0}]}]}],utilityCommands:[{command:"help",displayText:"Show available commands",description:"Displays a list of all available commands"},{command:"clear",displayText:"Clear terminal",description:"Clears the terminal output"},{command:"reset",displayText:"Reset website",description:"Resets the website to initial state (animated)"},{command:"auto",displayText:"Auto-generate website",description:"Automatically generate the website (animated)"},{command:"skip",displayText:"Skip to final content",description:"Instantly displays the final website content."}],flow:[{id:"p0-f-prompt",action:"log",logMessage:"[USER] build awesome profile page with lots of cool skills",logType:"user"},{id:"p0-f-proc-req",action:"log",logMessage:"[PROCESSING] Request analysis initiated",logType:"system"},{id:"p0-f-render-initial-example",action:"renderInitial",logMessage:"[ANALYZING] Example site template detected",logType:"system"},{id:"p0-f-delay1",action:"delay",delayMs:330},{id:"p0-f-wipe",action:"clearContentArea",logMessage:"[PLANNING] Preparing for full site generation",logType:"system"},{id:"p0-f-delay2",action:"delay",delayMs:170},{id:"p1-f-log-draft-start",action:"log",logMessage:"[SYSTEM] Generating initial V1 draft of the website...",logType:"system"},{id:"p1-f-hdr-log",action:"log",logMessage:"[RENDERING V1] Header section...",logType:"checking"},{id:"p1-f-hdr-name",action:"renderElement",targetSectionId:"header",targetElementId:"header-h1-name",targetVersionId:"v1"},{id:"p1-f-hdr-title",action:"renderElement",targetSectionId:"header",targetElementId:"header-h2-title",targetVersionId:"v1"},{id:"p1-f-sep1",action:"renderSection",targetSectionId:"sep1"},{id:"p1-f-about-log",action:"log",logMessage:"[RENDERING V1] About Me section...",logType:"checking"},{id:"p1-f-about-h2",action:"renderElement",targetSectionId:"about",targetElementId:"about-h2",targetVersionId:"v1"},{id:"p1-f-about-p1",action:"renderElement",targetSectionId:"about",targetElementId:"about-p1",targetVersionId:"v1"},{id:"p1-f-about-p2",action:"renderElement",targetSectionId:"about",targetElementId:"about-p2",targetVersionId:"v1"},{id:"p1-f-sep2",action:"renderSection",targetSectionId:"sep2"},{id:"p1-f-skills-log",action:"log",logMessage:"[RENDERING V1] Skills section...",logType:"checking"},{id:"p1-f-skills-h2",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-h2",targetVersionId:"v1"},{id:"p1-f-skills-js",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-js",targetVersionId:"v1"},{id:"p1-f-skills-html",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-html",targetVersionId:"v1"},{id:"p1-f-skills-react",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-react",targetVersionId:"v1"},{id:"p1-f-skills-node",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-node",targetVersionId:"v1"},{id:"p1-f-skills-uiux",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-uiux",targetVersionId:"v1"},{id:"p1-f-sep3",action:"renderSection",targetSectionId:"sep3"},{id:"p1-f-contact-log",action:"log",logMessage:"[RENDERING V1] Contact section...",logType:"checking"},{id:"p1-f-contact-h2",action:"renderElement",targetSectionId:"contact",targetElementId:"contact-h2",targetVersionId:"v1"},{id:"p1-f-contact-email",action:"renderElement",targetSectionId:"contact",targetElementId:"contact-email",targetVersionId:"v1"},{id:"p1-f-contact-github",action:"renderElement",targetSectionId:"contact",targetElementId:"contact-github",targetVersionId:"v1"},{id:"p1-f-contact-linkedin",action:"renderElement",targetSectionId:"contact",targetElementId:"contact-linkedin",targetVersionId:"v1"},{id:"p1-f-log-draft-end",action:"log",logMessage:"[SYSTEM] Initial V1 draft complete.",logType:"system"},{id:"p1-f-delay-after-v1",action:"delay",delayMs:500},{id:"p2-f-log-review-start",action:"log",logMessage:"[AI_SYSTEM] Commencing review and refinement of the V1 draft...",logType:"system"},{id:"p2-f-thought-review",action:"thought",logMessage:"[AI_THOUGHT] The V1 draft is a solid foundation. Let's enhance it for clarity, impact, and detail.",logType:"ai-thought"},{id:"p2-f-delay-after-thought",action:"delay",delayMs:670},{id:"p3-f-hdr-revisit-log",action:"log",logMessage:"[AI_REVISIT] Revisiting Header section for enhancements...",logType:"system"},{id:"p3-f-hdr-visual-start",action:"setSectionVisualState",targetSectionId:"header",targetSectionVisualState:"inProgress"},{id:"p3-f-hdr-thought",action:"thought",logMessage:"[AI_THOUGHT] The title 'Developer & Designer' is good, but 'Full-Stack Developer & UX Designer' is more specific for the enhanced profile.",logType:"ai-thought"},{id:"p3-f-hdr-delay-thought",action:"delay",delayMs:400},{id:"p3-f-hdr-title-update",action:"updateElement",targetSectionId:"header",targetElementId:"header-h2-title",targetVersionId:"v2",logMessage:"[REVISING] Header title refined.",logType:"checking"},{id:"p3-f-hdr-visual-end",action:"setSectionVisualState",targetSectionId:"header",targetSectionVisualState:"default"},{id:"p3-f-hdr-delay-after",action:"delay",delayMs:330},{id:"p4-f-about-revisit-log",action:"log",logMessage:"[AI_REVISIT] Refining 'About Me' section...",logType:"system"},{id:"p4-f-about-visual-start",action:"setSectionVisualState",targetSectionId:"about",targetSectionVisualState:"inProgress"},{id:"p4-f-about-p1-thought",action:"thought",logMessage:"[AI_THOUGHT] For 'About Me P1': The initial statement is okay. Let's make it more professional and highlight expertise.",logType:"ai-thought"},{id:"p4-f-about-p1-delay",action:"delay",delayMs:400},{id:"p4-f-about-p1-update",action:"updateElement",targetSectionId:"about",targetElementId:"about-p1",targetVersionId:"v2",logMessage:"[REVISING] About Me - P1 updated.",logType:"checking"},{id:"p4-f-about-p2-thought",action:"thought",logMessage:"[AI_THOUGHT] For 'About Me P2': The website demo description can be expanded to showcase problem-solving abilities.",logType:"ai-thought"},{id:"p4-f-about-p2-delay",action:"delay",delayMs:400},{id:"p4-f-about-p2-update",action:"updateElement",targetSectionId:"about",targetElementId:"about-p2",targetVersionId:"v2",logMessage:"[REVISING] About Me - P2 updated.",logType:"checking"},{id:"p4-f-about-visual-end",action:"setSectionVisualState",targetSectionId:"about",targetSectionVisualState:"default"},{id:"p4-f-about-delay-after",action:"delay",delayMs:330},{id:"p5-f-skills-revisit-log",action:"log",logMessage:"[AI_REVISIT] Enhancing 'Skills' section...",logType:"system"},{id:"p5-f-skills-visual-start",action:"setSectionVisualState",targetSectionId:"skills",targetSectionVisualState:"inProgress"},{id:"p5-f-skills-h2-thought",action:"thought",logMessage:"[AI_THOUGHT] Changing 'Skills' header to 'Core Skills' for better focus.",logType:"ai-thought"},{id:"p5-f-skills-h2-update",action:"updateElement",targetSectionId:"skills",targetElementId:"skills-h2",targetVersionId:"v2",logMessage:"[REVISING] Skills header updated.",logType:"checking"},{id:"p5-f-skills-js-thought",action:"thought",logMessage:"[AI_THOUGHT] Expanding JavaScript/TypeScript with specific frameworks.",logType:"ai-thought"},{id:"p5-f-skills-js-update",action:"updateElement",targetSectionId:"skills",targetElementId:"skills-js",targetVersionId:"v2",logMessage:"[REVISING] JavaScript/TypeScript skills detailed.",logType:"checking"},{id:"p5-f-skills-node-thought",action:"thought",logMessage:"[AI_THOUGHT] Adding specifics for Node.js.",logType:"ai-thought"},{id:"p5-f-skills-node-update",action:"updateElement",targetSectionId:"skills",targetElementId:"skills-node",targetVersionId:"v2",logMessage:"[REVISING] Node.js skills detailed.",logType:"checking"},{id:"p5-f-skills-uiux-thought",action:"thought",logMessage:"[AI_THOUGHT] Detailing UI/UX Design tools.",logType:"ai-thought"},{id:"p5-f-skills-uiux-update",action:"updateElement",targetSectionId:"skills",targetElementId:"skills-uiux",targetVersionId:"v2",logMessage:"[REVISING] UI/UX Design skills detailed.",logType:"checking"},{id:"p5-f-skills-add-thought",action:"thought",logMessage:"[AI_THOUGHT] Incorporating additional key competencies: Python, API Design, Cloud, and DevOps.",logType:"ai-thought"},{id:"p5-f-skills-add-python",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-python",targetVersionId:"v2",logMessage:"[ADDING] Python skills integrated.",logType:"checking"},{id:"p5-f-skills-add-graphql",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-graphql",targetVersionId:"v2",logMessage:"[ADDING] API Design skills integrated.",logType:"checking"},{id:"p5-f-skills-add-cloud",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-cloud",targetVersionId:"v2",logMessage:"[ADDING] Cloud Architecture skills integrated.",logType:"checking"},{id:"p5-f-skills-add-devops",action:"renderElement",targetSectionId:"skills",targetElementId:"skills-devops",targetVersionId:"v2",logMessage:"[ADDING] DevOps skills integrated.",logType:"checking"},{id:"p5-f-skills-react-thought",action:"thought",logMessage:"[AI_THOUGHT] The separate 'React' line is now redundant due to expanded JS/TS details. Consolidating for clarity.",logType:"ai-thought"},{id:"p5-f-skills-remove-react",action:"removeElement",targetElementId:"skills-react",logMessage:"[OPTIMIZING] Skill list consolidated.",logType:"checking"},{id:"p5-f-skills-visual-end",action:"setSectionVisualState",targetSectionId:"skills",targetSectionVisualState:"default"},{id:"p5-f-skills-delay-after",action:"delay",delayMs:330},{id:"p6-f-contact-review-log",action:"log",logMessage:"[AI_REVIEW] Contact section reviewed. V1 content is final.",logType:"system"},{id:"p6-f-contact-delay",action:"delay",delayMs:330},{id:"p7-f-final-checks",action:"log",logMessage:"[VERIFYING] All revisions and enhancements complete. Final content inspection...",logType:"system"},{id:"p7-f-gen-complete",action:"log",logMessage:"[COMPLETE] Enhanced portfolio generated successfully!",logType:"system"}]};class E{constructor(e,t){this.currentFlowStepIndex=0,this.commandTimeout=null,this.isRunning=!1,this.enhancedMode=!1,this.uiController=e,this.sitePlan=t,this.animationSettings=this.sitePlan.meta.animationSettings||{},this.uiController.updateAnimationSettings(this.animationSettings)}initialize(){new URLSearchParams(window.location.search).get("instant")==="true"?this.renderFinalSiteDirectly():this.startInitialAnimatedSequence()}startInitialAnimatedSequence(){this.resetState(),document.title=this.sitePlan.meta.siteTitle||"Leo Vainio (0%)",this.uiController.addLogEntry(this.sitePlan.meta.initialUserPrompt,"user"),this.isRunning=!0,this.executeNextFlowStep()}async executeNextFlowStep(){if(!this.isRunning||this.currentFlowStepIndex>=this.sitePlan.flow.length){console.log("Flow sequence complete or stopped."),this.isRunning=!1;return}const e=this.sitePlan.flow[this.currentFlowStepIndex];this.currentFlowStepIndex++,this.updateTitleProgress(),e.logMessage&&e.logType!=="user"&&this.uiController.addLogEntry(e.logMessage,e.logType||"system"),await this.executeFlowStepAction(e)}async executeFlowStepAction(e){var n;const t=this.animationSettings.commandDelay||800;switch(e.action){case"log":this.scheduleNextStep(t);break;case"delay":this.scheduleNextStep(e.delayMs||t);break;case"renderInitial":const o=this.sitePlan.sections.filter(s=>s.displayInitially).map(s=>({id:s.id,elements:s.elements||[],className:s.className}));this.uiController.renderInitialPageContent(o),this.scheduleNextStep(t);break;case"clearContentArea":await this.uiController.wipeAndClearContent(),this.scheduleNextStep(this.animationSettings.wipeDelay||500);break;case"renderSection":if(e.targetSectionId){const s=this.sitePlan.sections.find(a=>a.id===e.targetSectionId);s?await this.renderSectionAnimated(s):console.warn(`Target section ${e.targetSectionId} not found for step ${e.id}`)}this.scheduleNextStep(0);break;case"renderElement":if(e.targetSectionId&&e.targetElementId){const s=this.sitePlan.sections.find(l=>l.id===e.targetSectionId),a=(n=s==null?void 0:s.elements)==null?void 0:n.find(l=>l.id===e.targetElementId);if(a){const l=this.enhancedMode&&a.versions.find(d=>d.isFinal)?a.versions.find(d=>d.isFinal).versionId:e.targetVersionId||a.versions[0].versionId,c=a.versions.find(d=>d.versionId===l);c?(await this.uiController.renderAnimatedElement(e.targetSectionId,a,c.text),c.logMessage&&this.uiController.addLogEntry(c.logMessage,"system")):console.warn(`Version ${l} for element ${e.targetElementId} not found.`)}else console.warn(`Target element ${e.targetElementId} in section ${e.targetSectionId} not found.`)}this.scheduleNextStep(0);break;case"updateElement":if(e.targetElementId&&e.targetVersionId){const s=this.findElementById(e.targetElementId);if(s){const a=s.versions.find(l=>l.versionId===e.targetVersionId);a?(a.critiqueOfPrevious&&e.logType!=="ai-thought"&&(this.uiController.addLogEntry(`[AI_REASONING] ${a.critiqueOfPrevious}`,"ai-thought"),await this.delay(this.animationSettings.lineDelay||100)),await this.uiController.updateAnimatedElement(e.targetElementId,a.text),a.logMessage&&e.logMessage!==a.logMessage&&this.uiController.addLogEntry(a.logMessage,"system")):console.warn(`Version ${e.targetVersionId} for element ${e.targetElementId} not found for update.`)}else console.warn(`Element ${e.targetElementId} not found for update.`)}this.scheduleNextStep(t);break;case"removeElement":e.targetElementId?this.uiController.removeElementById(e.targetElementId):e.targetSectionId&&this.uiController.removeSectionWrapper(e.targetSectionId),this.scheduleNextStep(t);break;case"thought":this.scheduleNextStep(e.delayMs||t);break;case"setSectionVisualState":e.targetSectionId&&e.targetSectionVisualState&&this.uiController.setSectionVisualState(e.targetSectionId,e.targetSectionVisualState),this.scheduleNextStep(e.delayMs!==void 0?e.delayMs:t/2);break;default:console.warn(`Unknown flow step action: ${e.action}`),this.scheduleNextStep(t)}}async renderSectionAnimated(e){if(this.uiController.ensureSectionWrapper(e.id,e.className),e.type==="block"&&e.elements)for(const t of e.elements){const n=this.enhancedMode&&t.versions.find(i=>i.isFinal)?t.versions.find(i=>i.isFinal):t.versions[0];n?(await this.uiController.renderAnimatedElement(e.id,t,n.text),n.logMessage&&this.uiController.addLogEntry(n.logMessage,"system")):console.warn(`No suitable version found for element ${t.id} in section ${e.id}`)}else if(e.type==="separator"&&e.separatorText){const t={id:e.id+"-element",tag:"p",versions:[{versionId:"v1",text:e.separatorText}],className:"separator"};await this.uiController.renderAnimatedElement(e.id,t,e.separatorText)}}findElementById(e){for(const t of this.sitePlan.sections)if(t.elements){const n=t.elements.find(i=>i.id===e);if(n)return n}}scheduleNextStep(e){this.isRunning&&(this.clearCommandTimeout(),this.commandTimeout=setTimeout(()=>{this.executeNextFlowStep()},e))}renderFinalSiteDirectly(){this.resetState(!0),this.uiController.addLogEntry("[SYSTEM] Displaying final site content.","system"),document.title=this.sitePlan.meta.siteTitle,this.sitePlan.sections.forEach(e=>{if(e.id!=="initialExample"){if(this.uiController.ensureSectionWrapper(e.id,e.className),e.type==="block"&&e.elements)e.elements.forEach(t=>{let n=t.versions.find(i=>i.isFinal===!0);!n&&t.versions.length>0&&(n=t.versions[t.versions.length-1]),n&&this.uiController.renderElementDirectly(e.id,t,n.text)});else if(e.type==="separator"&&e.separatorText){const t={id:e.id+"-element",tag:"p",versions:[{versionId:"v1",text:e.separatorText}],className:"separator"};this.uiController.renderElementDirectly(e.id,t,e.separatorText)}}}),this.uiController.addLogEntry("[COMPLETE] Site rendered.","system"),this.isRunning=!1}handleCommand(e){e=e.trim().toLowerCase();const t=this.sitePlan.utilityCommands.find(n=>n.command===e);if(e===g.toLowerCase())return this.uiController.addLogEntry(`[Request] ${g}`,"system"),this.uiController.addLogEntry("[Processing] Enhancing skill set and re-generating...","checking"),this.enhancedMode=!0,this.startInitialAnimatedSequence(),!0;if(t){switch(t.command){case"help":this.showHelp();break;case"clear":this.uiController.clearLog();break;case"reset":this.enhancedMode=!1,this.startInitialAnimatedSequence();break;case"auto":this.enhancedMode=!1,this.startInitialAnimatedSequence();break;case"skip":this.renderFinalSiteDirectly();break}return!0}return this.uiController.addLogEntry(`[Error] Unknown command: "${e}"`,"error"),this.uiController.addLogEntry("[Help] Type 'help' for available commands","system"),!1}resetState(e=!1){this.isRunning=!1,this.currentFlowStepIndex=0,this.clearCommandTimeout(),this.uiController.clearAllTimeouts(),e||this.uiController.clearLog(),this.uiController.clearContentImmediate()}clearCommandTimeout(){this.commandTimeout&&(clearTimeout(this.commandTimeout),this.commandTimeout=null)}delay(e){return new Promise(t=>setTimeout(t,e))}updateTitleProgress(){const e=Math.round(this.currentFlowStepIndex/this.sitePlan.flow.length*100),t=this.sitePlan.meta.siteTitle||"Leo Vainio";document.title=`${t} (${e}%)`}showHelp(){this.uiController.addLogEntry("[Help] Available commands:","system"),this.sitePlan.utilityCommands.forEach(e=>{this.uiController.addLogEntry(`  ${e.command}: ${e.description}`,"")}),this.uiController.addLogEntry(`  "${g}" (Special request to enhance & regenerate)`,"")}}function S(){const r=new u,e=new E(r,y);r.setupCommandInput(e.handleCommand.bind(e)),e.initialize()}document.addEventListener("DOMContentLoaded",S);
